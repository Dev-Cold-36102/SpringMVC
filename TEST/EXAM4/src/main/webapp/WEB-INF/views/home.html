<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <!--    <meta charset="UTF-8">-->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
          integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>home</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.1.min.js"></script>
</head>
<body>
<div style="padding-left: 100px">
    <br>
    <br>
    <h2 th:text="${message}"></h2>
    <h2>DANH SACH THANH PHO</h2>
    <button><a href="/create"> Them Thanh Pho</a></button>
    <br>
    <table class="table table-bordered text-center" style="width: 1000px">
        <thead>
        <tr>
            <th scope="col">#</th>
            <th scope="col">city</th>
            <th scope="col">country</th>
            <th scope="col">Action</th>
        </tr>
        </thead>
        <tbody th:each="city,iter :${cities}">
        <tr>
            <td><p th:text="${iter.index+1}"></p></td>
            <td><a th:href="@{'/view/'+${city.id}}"><p th:text="${city.getName()}"></p></a></td>
            <td><p th:text="${city.getCountry().getName()}"></p></td>
            <td><a th:href="@{'/edit/'+${city.id}}">edit</a>|<a th:name="${city.id}" onclick="doDelete(this.name)">delete</a></td>
        </tr>
        </tbody>
    </table>
</div>

</body>
<script>
    function doDelete(id) {
        const apiBaseUrl = 'http://localhost:8080';
        if (confirm("Xac nhan xoa?")) {
            {
                $.ajax(`${apiBaseUrl}/delete/${id}`)
                    .done(function (result) {
                        window.location.reload(); // then reload the page.(3)
                    })
                    .fail(function (error) {
                        console.log(error);
                    });
            }
        }
    };
</script>
</html>